<!DOCTYPE html>
<!-- The lang attribute will be set by JavaScript -->
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="" data-lang-key="metaDescription">
    <title>PT Digital Sandi Informasi - Merancang Masa Depan Digital Anda</title>

    <!-- Scripts & Stylesheets -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="icon" type="image/png" href="public/images/dsi-logo.png">

    <style>
        html {
            scroll-behavior: smooth;
        }

        /* --- Base Styles --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F7;
            color: #1D1D1F;
            transition: background-color 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
        }

        .dark body {
            background-color: #000;
            color: #F5F5F7;
        }

        /* --- Section-Specific Backgrounds --- */
        #hero {
            background: linear-gradient(135deg, #e0f2fe 0%, #a5f3fc 50%, #67e8f9 100%);
            animation: gradient-animation 15s ease infinite;
            background-size: 200% 200%;
        }

        .dark #hero {
            background: linear-gradient(135deg, #020024 0%, #794009 35%, #00165d 100%);
            animation: gradient-animation 15s ease infinite;
            background-size: 200% 200%;
        }

        #services {
            background-image: radial-gradient(circle, rgba(0, 0, 0, 0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .dark #services {
            background-image: radial-gradient(circle, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        #contact {
            position: relative;
            overflow: hidden;
        }

        #contact::before {
            content: '';
            position: absolute;
            z-index: -1;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150%;
            padding-bottom: 150%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(41, 151, 255, 0.1) 0%, rgba(245, 245, 247, 0) 60%);
            animation: pulse-glow 8s infinite ease-in-out;
        }

        .dark #contact::before {
            background: radial-gradient(circle, rgba(41, 151, 255, 0.1) 0%, rgba(0, 0, 0, 0) 60%);
        }

        /* --- Animations --- */
        @keyframes gradient-animation {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes pulse-glow {
            0% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.7;
            }

            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.7;
            }
        }

        @keyframes breathe {

            0%,
            100% {
                transform: scale(1);
                box-shadow: 0 10px 20px rgba(41, 151, 255, 0.2);
            }

            50% {
                transform: scale(1.05);
                box-shadow: 0 15px 30px rgba(41, 151, 255, 0.3);
            }
        }

        @keyframes marquee {
            0% {
                transform: translateX(0%);
            }

            100% {
                transform: translateX(-100%);
            }
        }

        @keyframes typing-dot {

            0%,
            60%,
            100% {
                transform: translateY(0);
            }

            30% {
                transform: translateY(-4px);
            }
        }

        /* --- Enhanced Component Styles --- */
        .btn-primary {
            animation: breathe 4s ease-in-out infinite;
            background-color: #2997FF;
            color: #FFFFFF;
        }
        .dark .btn-primary {
            background-color: #1E90FF;
        }

        .service-card {
            position: relative;
            transition: transform 0.3s ease;
        }

        .service-card:hover {
            transform: translateY(-8px);
        }

        .card-border-svg {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            /* Allows clicks to go through to the card content */
        }

        .card-border-path {
            stroke: #2997FF;
            /* Border color */
            stroke-width: 2px;
            /* Border thickness */
            stroke-dasharray: 2000;
            /* A large number to cover the whole path */
            stroke-dashoffset: 2000;
            /* Start with the border "drawn" off-screen */
            transition: stroke-dashoffset 0.5s ease-in-out;
        }

        .service-card:hover .card-border-path {
            stroke-dashoffset: 0;
            /* Animate the border to be fully "drawn" on hover */
        }

        .philosophy-line {
            width: 0;
            transition: width 1s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .is-visible .philosophy-line {
            width: 100%;
        }

        /* Styling for the process circles and connectors */
        /* This is the new, high-contrast style */
        .process-circle.is-active {
            /* background-color: #2997FF !important; */
            /* Make the background blue */
            border-color: #2997FF !important;
            /* Keep the border blue */
            color: #2997FF !important;
            /* Make the number white for high contrast */
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(41, 151, 255, 0.5);
        }

        .dark .process-circle.is-active {
            color: #FFFFFF !important;
        }

        .process-connector-progress {
            width: 0;
            transition: width 0.5s ease-in-out;
        }

        .process-connector.is-active .process-connector-progress {
            width: 100%;
        }

        /* Responsive layout for Our Process section */
        @media (max-width: 768px) {
            #process .flex.items-start.justify-between.relative {
                flex-direction: column;
                align-items: center;
            }


            #process .process-step {
                width: 100%;
                max-width: 250px;
                margin-bottom: 2rem;
            }


            #process .process-connector {
                display: block;
                width: 4px;
                height: 60px;
                margin: 0 auto;
                background-color: rgba(156, 163, 175, 0.5);
                /* gray-400 tone */
                position: relative;
            }


            #process .process-connector-progress {
                height: 0;
                width: 100%;
                transition: height 0.5s ease-in-out;
            }


            #process .process-connector.is-active .process-connector-progress {
                height: 100%;
            }

            #process .process-circle {
                border-color: #2997FF !important;
                color: #FFFFFF !important;
                /* background-color: #2997FF !important; */
                box-shadow: 0 0 10px rgba(41, 151, 255, 0.5);
            }
        }


        #strategy-output .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #2997FF;
            margin: 0 2px;
            animation: typing-dot 1.4s infinite;
        }

        #strategy-output .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        #strategy-output .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        .partner-marquee .marquee-content {
            display: flex;
            animation: marquee 30s linear infinite;
        }

        .partner-marquee .marquee-content>* {
            flex-shrink: 0;
            width: 25%;
            padding: 0 2rem;
        }

        /* Base styles from original file */
        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            opacity: 1;
            /* Hidden by default */
            transition: opacity 0.5s ease;
        }

        .glass-card {
            backdrop-filter: blur(25px) saturate(150%);
            -webkit-backdrop-filter: blur(25px) saturate(150%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgb(255 255 255 / 79%);
            ;
            border: 1px solid rgba(0, 0, 0, 0.08);


        }

        .dark .glass-card {
            background: rgba(26, 26, 26, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-nav {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .light .glass-nav {
            background: rgba(245, 245, 247, 0.7);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }

        .dark .glass-nav {
            background: rgba(0, 0, 0, 0.6);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-primary:disabled {
            background-color: #4a5568;
            cursor: not-allowed;
        }

        .btn-secondary {
            transition: background-color 0.3s ease;
        }

        .light .btn-secondary {
            background-color: rgba(0, 0, 0, 0.05);
            color: #1D1D1F;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .light .btn-secondary:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .dark .btn-secondary {
            background-color: rgba(255, 255, 255, 0.1);
            color: #F5F5F7;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .dark .btn-secondary:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .fade-in-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .nav-active {
            color: #2997FF !important;
        }

        .lang-switcher button {
            transition: color 0.2s ease;
        }

        .lang-switcher .lang-active {
            color: #2997FF;
            font-weight: 600;
        }

        .ai-response-container {
            min-height: 200px;
        }

        .ai-response-container h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2997FF;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .ai-response-container h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
        }

        .dark .ai-response-container h4 {
            color: #fff;
        }

        .ai-response-container ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .ai-response-container li {
            margin-bottom: 0.5rem;
        }

        .ai-response-container p {
            margin-bottom: 1rem;
        }

        .loader {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-left-color: #2997FF;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .ai-warning {
            background-color: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #FFC107;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            color: #b8860b;
        }

        .dark .ai-warning {
            color: #FFD54F;
        }

        .ai-warning strong {
            color: #FFC107;
        }

        #cookie-consent-banner.hidden {
            display: none;
        }

        #cookie-consent-banner {
            animation: slide-up 0.5s ease-out forwards;
        }

        @keyframes slide-up {
            from {
                transform: translateY(100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .typing-cursor::after {
            content: 'â–‹';
            /* Using a block character for the cursor */
            display: inline-block;
            animation: blink-caret 0.75s step-end infinite;
            color: #2997FF;
            /* Cursor color */
            margin-left: 2px;
        }

        @keyframes blink-caret {

            from,
            to {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }

        /* --- NEW: Hero Text Animation --- */
        @keyframes text-slide-up {
            from {
                transform: translateY(40px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .hero-text-enter {
            animation: text-slide-up 1s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }

        .hero-text-exit {
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .bouncing-dots {
            display: flex;
            gap: 8px;
        }

        .bouncing-dots span {
            width: 12px;
            height: 12px;
            background-color: #2997FF; /* Change to desired color */
            border-radius: 50%;
            animation: bounce 0.6s infinite ease-in-out;
        }
        .dark .bouncing-dots span {
            background-color: #FFD700; /* Change to desired color */
        }

        .bouncing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .bouncing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }
    </style>
</head>

<body class="antialiased">
    <!-- Loading -->
    <div id="loading-screen"
        class="fixed inset-0 bg-white dark:bg-black flex items-center justify-center z-50 transition-opacity duration-500">
        <div class="bouncing-dots">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <svg class="absolute w-0 h-0">
        <defs>
            <filter id="threshold">
                <feGaussianBlur stdDeviation="0.6" in="SourceGraphic" result="blurred" />
                <feColorMatrix in="blurred" type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 25 -10"
                    result="threshold" />
            </filter>
        </defs>
    </svg>

    <div id="particles-js"></div>
    <!-- Header & Navigation -->
    <header class="glass-nav fixed top-0 left-0 right-0 z-50">
        <!-- ... Same as before ... -->
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-semibold text-black dark:text-white flex items-center gap-x-2">
                <img src="public/images/dsi-logo.png" class="h-auto max-h-10" alt="dsi-logo">
                <div class="leading-tight">
                    <span>Digital Sandi Informasi</span>
                    <span class="block text-sm font-light italic text-gray-600 dark:text-gray-300">Mobile
                        Lifestyle</span>
                </div>
            </a>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#philosophy"
                    class="text-gray-500 hover:text-black dark:text-gray-300 dark:hover:text-white transition-colors text-md"
                    data-lang-key="navPhilosophy"></a>
                <a href="#services"
                    class="text-gray-500 hover:text-black dark:text-gray-300 dark:hover:text-white transition-colors text-md"
                    data-lang-key="navServices"></a>
                <a href="#partners"
                    class="text-gray-500 hover:text-black dark:text-gray-300 dark:hover:text-white transition-colors text-md"
                    data-lang-key="navPartners"></a>
                <a href="#process"
                    class="text-gray-500 hover:text-black dark:text-gray-300 dark:hover:text-white transition-colors text-md"
                    data-lang-key="navProcess"></a>
                <a href="#ai-strategy"
                    class="text-gray-500 hover:text-black dark:text-gray-300 dark:hover:text-white transition-colors text-md"
                    data-lang-key="navAiStrategy"></a>
                <a href="#contact"
                    class="text-gray-500 hover:text-black dark:text-gray-300 dark:hover:text-white transition-colors text-md"
                    data-lang-key="navContact"></a>

                <button id="theme-toggle-btn"
                    class="text-gray-500 dark:text-gray-300 hover:text-black dark:hover:text-white transition-colors">
                    <i id="theme-toggle-sun-icon" class="bi bi-sun-fill text-xl"></i>
                    <i id="theme-toggle-moon-icon" class="bi bi-moon-fill text-xl hidden"></i>
                </button>

                <div class="lang-switcher flex items-center space-x-2 text-gray-500 dark:text-gray-400">
                    <button id="lang-id" class="lang-active">ID</button>
                    <span>|</span>
                    <button id="lang-en">EN</button>
                </div>
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-black dark:text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
            </div>
        </nav>
        <div class="hidden md:hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#philosophy"
                    class="text-gray-500 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-800/50 hover:text-black dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium"
                    data-lang-key="navPhilosophy"></a>
                <a href="#services"
                    class="text-gray-500 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-800/50 hover:text-black dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium"
                    data-lang-key="navServices"></a>
                <a href="#partners"
                    class="text-gray-500 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-800/50 hover:text-black dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium"
                    data-lang-key="navPartners"></a>
                <a href="#process"
                    class="text-gray-500 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-800/50 hover:text-black dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium"
                    data-lang-key="navProcess"></a>
                <a href="#ai-strategy"
                    class="text-gray-500 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-800/50 hover:text-black dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium"
                    data-lang-key="navAiStrategy"></a>
                <a href="#contact"
                    class="text-gray-500 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-800/50 hover:text-black dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium"
                    data-lang-key="navContact"></a>
                <div class="flex justify-between items-center px-3 pt-4">
                    <div class="lang-switcher flex items-center space-x-4 text-gray-500 dark:text-gray-400">
                        <button id="lang-id-mobile" class="lang-active">Indonesia</button>
                        <span class="dark:text-gray-600">|</span>
                        <button id="lang-en-mobile">English</button>
                    </div>
                    <button id="theme-toggle-btn-mobile"
                        class="text-gray-500 dark:text-gray-300 hover:text-black dark:hover:text-white transition-colors">
                        <i id="theme-toggle-sun-icon-mobile" class="bi bi-sun-fill text-xl"></i>
                        <i id="theme-toggle-moon-icon-mobile" class="bi bi-moon-fill text-xl hidden"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="hero" class="min-h-screen flex items-center justify-center relative pt-20 overflow-hidden">
            <div class="container mx-auto px-6 text-center relative z-10">
                <div class="max-w-4xl mx-auto">
                    <!-- This is the updated line -->
                    <h1 class="text-4xl sm:text-5xl md:text-7xl font-bold text-black dark:text-white leading-tight mb-6 tracking-tight"
                        data-lang-key="heroTitle"></h1>
                    <p class="text-lg md:text-xl text-gray-600 dark:text-gray-400 max-w-2xl mx-auto mb-10"
                        data-lang-key="heroSubtitle"></p>
                    <div
                        class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-4">
                        <a href="#contact"
                            class="btn-primary font-semibold py-3 px-8 rounded-full text-lg w-full sm:w-auto"
                            data-lang-key="heroBtnPrimary"></a>
                        <a href="#services"
                            class="btn-secondary font-semibold py-3 px-8 rounded-full text-lg w-full sm:w-auto"
                            data-lang-key="heroBtnSecondary"></a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Philosophy Section -->
        <section id="philosophy" class="py-24 md:py-36 fade-in-section">
            <div class="container mx-auto px-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center max-w-5xl mx-auto">
                    <div class="md:col-span-1">
                        <h2 class="text-sm font-semibold uppercase text-blue-500 tracking-widest mb-2"
                            data-lang-key="philosophyTag"></h2>
                        <div class="philosophy-line h-1 bg-blue-500 rounded-full"></div>
                    </div>
                    <div class="md:col-span-2">
                        <p class="text-3xl md:text-4xl font-bold text-black dark:text-white"
                            data-lang-key="philosophyTitle"></p>
                        <p class="text-lg text-gray-600 dark:text-gray-400 mt-6" data-lang-key="philosophyBody"></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="py-24 md:py-36 fade-in-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-20">
                    <h2 class="text-4xl md:text-5xl font-bold text-black dark:text-white" data-lang-key="servicesTitle">
                    </h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400 mt-4 max-w-3xl mx-auto"
                        data-lang-key="servicesSubtitle"></p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
                    <!-- Service 1 -->
                    <div class="service-card glass-card rounded-3xl z-10">
                        <svg class="card-border-svg" width="100%" height="100%" fill="transparent"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect class="card-border-path" width="100%" height="100%" rx="24" ry="24" />
                        </svg>
                        <div class="service-content p-8 flex flex-col items-center text-center rounded-3xl">
                            <div
                                class="p-4 bg-gray-200/50 dark:bg-gray-800/50 rounded-xl mb-6 inline-block shadow-inner">
                                <i class="bi bi-phone text-3xl text-blue-500"></i>
                            </div>
                            <h3 class="text-2xl font-semibold mb-3 text-black dark:text-white"
                                data-lang-key="service1Title"></h3>
                            <p class="text-gray-700 dark:text-gray-300" data-lang-key="service1Body"></p>
                        </div>
                    </div>
                    <!-- Service 2 -->
                    <div class="service-card glass-card rounded-3xl z-10">
                        <svg class="card-border-svg" width="100%" height="100%" fill="transparent"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect class="card-border-path" width="100%" height="100%" rx="24" ry="24" />
                        </svg>
                        <div class="service-content p-8 flex flex-col items-center text-center rounded-3xl">
                            <div
                                class="p-4 bg-gray-200/50 dark:bg-gray-800/50 rounded-xl mb-6 inline-block shadow-inner">
                                <i class="bi bi-globe text-3xl text-blue-500"></i>
                            </div>
                            <h3 class="text-2xl font-semibold mb-3 text-black dark:text-white"
                                data-lang-key="service2Title"></h3>
                            <p class="text-gray-700 dark:text-gray-300" data-lang-key="service2Body"></p>
                        </div>
                    </div>
                    <!-- Service 3 -->
                    <div class="service-card glass-card rounded-3xl z-10">
                        <svg class="card-border-svg" width="100%" height="100%" fill="transparent"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect class="card-border-path" width="100%" height="100%" rx="24" ry="24" />
                        </svg>
                        <div class="service-content p-8 flex flex-col items-center text-center rounded-3xl">
                            <div
                                class="p-4 bg-gray-200/50 dark:bg-gray-800/50 rounded-xl mb-6 inline-block shadow-inner">
                                <i class="bi bi-shield-lock text-3xl text-blue-500"></i>
                            </div>
                            <h3 class="text-2xl font-semibold mb-3 text-black dark:text-white"
                                data-lang-key="service3Title"></h3>
                            <p class="text-gray-700 dark:text-gray-300" data-lang-key="service3Body"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Our Partners Section -->
        <section id="partners" class="py-24 md:py-36 fade-in-section overflow-hidden">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-5xl font-bold text-black dark:text-white" data-lang-key="partnersTitle">
                    </h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400 mt-4" data-lang-key="partnersSubtitle"></p>
                </div>
                <div class="partner-marquee relative w-full flex">
                    <div class="marquee-content">
                        <!-- Logos are duplicated for a seamless loop -->
                        <div class="flex justify-center items-center"><img src="public/images/mytelkomsel-logo.png"
                                alt="mytelkomsel-logo" class="max-h-16"></div>
                        <div class="flex justify-center items-center"><img src="public/images/smartferen-logo.png"
                                alt="smartfren-logo" class="max-h-16"></div>
                        <div class="flex justify-center items-center"><img src="public/images/xl-logo.webp"
                                alt="xl-logo" class="max-h-12"></div>
                        <div class="flex justify-center items-center"><img src="public/images/tri-logo.webp"
                                alt="tri-logo" class="max-h-16"></div>
                        <div class="flex justify-center items-center"><img src="public/images/mytelkomsel-logo.png"
                                alt="mytelkomsel-logo" class="max-h-16"></div>
                        <div class="flex justify-center items-center"><img src="public/images/smartferen-logo.png"
                                alt="smartfren-logo" class="max-h-16"></div>
                        <div class="flex justify-center items-center"><img src="public/images/xl-logo.webp"
                                alt="xl-logo" class="max-h-12"></div>
                        <div class="flex justify-center items-center"><img src="public/images/tri-logo.webp"
                                alt="tri-logo" class="max-h-16"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Our Process Section -->
        <section id="process" class="py-24 md:py-36 fade-in-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-20">
                    <h2 class="text-4xl md:text-5xl font-bold text-black dark:text-white" data-lang-key="processTitle">
                    </h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400 mt-4" data-lang-key="processSubtitle"></p>
                </div>

                <div class="relative max-w-6xl mx-auto">
                    <!-- This container holds the steps and the connecting lines -->
                    <div class="flex items-start justify-between relative">
                        <!-- Step 1 -->
                        <div class="process-step flex-1 text-center">
                            <div
                                class="process-circle w-20 h-20 mx-auto rounded-full bg-gray-200/50 dark:bg-gray-800/50 border-2 border-gray-300 dark:border-gray-700 flex items-center justify-center text-gray-400 dark:text-gray-500 text-3xl font-bold mb-4 transition-all duration-500">
                                1</div>
                            <h3 class="text-xl font-semibold text-black dark:text-white mb-2"
                                data-lang-key="step1Title"></h3>
                            <p class="text-gray-600 dark:text-gray-400" data-lang-key="step1Body"></p>
                        </div>

                        <!-- Connector 1 -->
                        <div
                            class="process-connector flex-1 mt-10 h-0.5 bg-gray-300 dark:bg-gray-700 relative top-0 hidden md:block">
                            <div class="process-connector-progress h-full bg-blue-500"></div>
                        </div>

                        <!-- Step 2 -->
                        <div class="process-step flex-1 text-center">
                            <div
                                class="process-circle w-20 h-20 mx-auto rounded-full bg-gray-200/50 dark:bg-gray-800/50 border-2 border-gray-300 dark:border-gray-700 flex items-center justify-center text-gray-400 dark:text-gray-500 text-3xl font-bold mb-4 transition-all duration-500">
                                2</div>
                            <h3 class="text-xl font-semibold text-black dark:text-white mb-2"
                                data-lang-key="step2Title"></h3>
                            <p class="text-gray-600 dark:text-gray-400" data-lang-key="step2Body"></p>
                        </div>

                        <!-- Connector 2 -->
                        <div
                            class="process-connector flex-1 mt-10 h-0.5 bg-gray-300 dark:bg-gray-700 relative top-0 hidden md:block">
                            <div class="process-connector-progress h-full bg-blue-500"></div>
                        </div>

                        <!-- Step 3 -->
                        <div class="process-step flex-1 text-center">
                            <div
                                class="process-circle w-20 h-20 mx-auto rounded-full bg-gray-200/50 dark:bg-gray-800/50 border-2 border-gray-300 dark:border-gray-700 flex items-center justify-center text-gray-400 dark:text-gray-500 text-3xl font-bold mb-4 transition-all duration-500">
                                3</div>
                            <h3 class="text-xl font-semibold text-black dark:text-white mb-2"
                                data-lang-key="step3Title"></h3>
                            <p class="text-gray-600 dark:text-gray-400" data-lang-key="step3Body"></p>
                        </div>

                        <!-- Connector 3 -->
                        <div
                            class="process-connector flex-1 mt-10 h-0.5 bg-gray-300 dark:bg-gray-700 relative top-0 hidden md:block">
                            <div class="process-connector-progress h-full bg-blue-500"></div>
                        </div>

                        <!-- Step 4 -->
                        <div class="process-step flex-1 text-center">
                            <div
                                class="process-circle w-20 h-20 mx-auto rounded-full bg-gray-200/50 dark:bg-gray-800/50 border-2 border-gray-300 dark:border-gray-700 flex items-center justify-center text-gray-400 dark:text-gray-500 text-3xl font-bold mb-4 transition-all duration-500">
                                4</div>
                            <h3 class="text-xl font-semibold text-black dark:text-white mb-2"
                                data-lang-key="step4Title"></h3>
                            <p class="text-gray-600 dark:text-gray-400" data-lang-key="step4Body"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Strategy Section -->
        <section id="ai-strategy" class="py-24 md:py-36 fade-in-section">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-4xl md:text-5xl font-bold text-black dark:text-white" data-lang-key="aiTitle"></h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400 mt-4 max-w-3xl mx-auto"
                        data-lang-key="aiSubtitle"></p>
                </div>
                <div class="glass-card rounded-3xl p-8 md:p-12 max-w-4xl mx-auto">
                    <div class="space-y-6">
                        <div>
                            <label for="business-goal"
                                class="block text-md font-medium text-gray-700 dark:text-gray-300 mb-2"
                                data-lang-key="aiInputLabel"></label>
                            <input type="text" id="business-goal"
                                class="w-full bg-gray-100 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-700 rounded-lg px-4 py-3 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow duration-300 focus:shadow-lg focus:shadow-blue-500/50"
                                data-lang-key="aiInputPlaceholder">
                        </div>
                        <button id="generate-strategy-btn"
                            class="btn-primary font-semibold py-3 px-8 rounded-full text-lg w-full"
                            data-lang-key="aiBtn"></button>
                    </div>
                    <div id="strategy-output" class="mt-8 ai-response-container text-gray-700 dark:text-gray-300"></div>
                </div>
            </div>
        </section>

        <!-- Contact / CTA Section -->
        <section id="contact" class="py-24 md:py-40 fade-in-section relative">
            <div class="container mx-auto px-6 text-center relative z-10">
                <div class="glass-card rounded-3xl p-8 md:p-16 max-w-4xl mx-auto">
                    <h2 class="text-4xl md:text-5xl font-bold text-black dark:text-white" data-lang-key="ctaTitle"></h2>
                    <p class="text-lg text-gray-600 dark:text-gray-400 mt-6 max-w-2xl mx-auto" data-lang-key="ctaBody">
                    </p>
                    <a href="mailto:cs@digitalsandiinformasi.com"
                        class="btn-primary font-semibold py-3 px-8 rounded-full text-lg inline-block mt-10 hover:scale-105 transition-transform"
                        data-lang-key="ctaBtn"></a>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-200 dark:border-gray-800/50 mt-20">
        <!-- ... Same as before ... -->
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="md:col-span-1">
                    <a href="#"
                        class="text-2xl font-semibold text-black dark:text-white flex flex-col items-start gap-y-2">
                        <img src="public/images/dsi-logo.png" class="h-auto max-h-10" alt="dsi-logo">
                        <div class="leading-tight"><span>Digital Sandi Informasi</span></div>
                        <span class="block text-sm font-light italic text-gray-600 dark:text-gray-300">Mobile
                            Lifestyle</span>
                    </a>
                    <p class="text-gray-600 dark:text-gray-400 mt-4" data-lang-key="footerTagline"></p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-black dark:text-white" data-lang-key="footerNav"></h3>
                    <ul class="mt-4 space-y-2">
                        <li><a href="#philosophy"
                                class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white"
                                data-lang-key="navPhilosophy"></a></li>
                        <li><a href="#services"
                                class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white"
                                data-lang-key="navServices"></a></li>
                        <li><a href="#partners"
                                class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white"
                                data-lang-key="navPartners"></a></li>
                        <li><a href="#process"
                                class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white"
                                data-lang-key="navProcess"></a></li>
                        <li>
                            <a href="https://layanan112.komdigi.go.id/" target="_blank" rel="noopener"
                                class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white">112</a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-black dark:text-white" data-lang-key="footerContact"></h3>
                    <address class="mt-4 space-y-2 not-italic text-gray-600 dark:text-gray-400">
                        <p data-lang-key="footerAddress"></p>
                        <p><span data-lang-key="footerPhone"></span> <a href="tel:+622157953431"
                                class="hover:text-black dark:hover:text-white">(+62) 21 5795 3431</a></p>
                        <p>E-mail: <a
                                href="mailto:cs@digitalsandiinformasi.com?subject=[Inquiry] &body=Hello, I would like to..."
                                class="hover:text-black dark:hover:text-white">cs@digitalsandiinformasi.com</a></p>
                    </address>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-black dark:text-white" data-lang-key="footerConnect"></h3>
                    <ul class="mt-4 space-y-2">
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white">LinkedIn</a>
                        </li>
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-black dark:hover:text-white">Twitter</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div
                class="mt-12 border-t border-gray-200 dark:border-gray-800/50 pt-8 text-center text-gray-500 dark:text-gray-500">
                <p>&copy; 2025 PT Digital Sandi Informasi. All Rights Reserved.</p>
                <p class="mt-2 text-sm" data-lang-key="footerSubtext"></p>
            </div>
        </div>
    </footer>

    <!-- Cookie Consent Banner -->
    <div id="cookie-consent-banner" class="fixed bottom-0 inset-x-0 pb-4 sm:pb-6 z-50 hidden">
        <div class="container mx-auto px-6">
            <div class="glass-card rounded-2xl p-6 sm:flex sm:items-center sm:justify-between">
                <p class="text-sm text-gray-700 dark:text-gray-300 mb-4 sm:mb-0 sm:mr-6" data-lang-key="cookieText"></p>
                <div class="flex-shrink-0 flex flex-col sm:flex-row items-center gap-3">
                    <button id="cookie-accept-btn"
                        class="btn-primary font-semibold py-2 px-6 rounded-full w-full sm:w-auto flex items-center justify-center">
                        <span data-lang-key="cookieAccept"></span>
                        <span id="accept-timer" class="ml-2 font-normal"></span>
                    </button>
                    <button id="cookie-decline-btn"
                        class="btn-secondary font-semibold py-2 px-6 rounded-full w-full sm:w-auto"
                        data-lang-key="cookieDecline"></button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Loading Screen
            const loadingScreen = document.getElementById('loading-screen');
            setTimeout(() => {
                loadingScreen.style.opacity = '0';
                setTimeout(() => loadingScreen.style.display = 'none', 500);
            }, 500); // Minimum 0.5 second loading screen


            const docEl = document.documentElement;

            function applyTheme(theme) {
                if (theme === 'dark') docEl.classList.add('dark'); else docEl.classList.remove('dark');
                document.getElementById('theme-toggle-sun-icon').classList.toggle('hidden', theme === 'dark');
                document.getElementById('theme-toggle-moon-icon').classList.toggle('hidden', theme !== 'dark');
                document.getElementById('theme-toggle-sun-icon-mobile').classList.toggle('hidden', theme === 'dark');
                document.getElementById('theme-toggle-moon-icon-mobile').classList.toggle('hidden', theme !== 'dark');
            }

            function handleThemeToggle() {
                const newTheme = docEl.classList.contains('dark') ? 'light' : 'dark';
                localStorage.setItem('theme', newTheme);
                applyTheme(newTheme);
                setupParticles(newTheme === 'dark');
            }

            document.getElementById('theme-toggle-btn').addEventListener('click', handleThemeToggle);
            document.getElementById('theme-toggle-btn-mobile').addEventListener('click', handleThemeToggle);

            const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            applyTheme(savedTheme);

            // --- All other logic ---
            // Cookie Consent, Language Switcher, Animations, etc.
            // This is a condensed version of your previous script, no changes in functionality
            const consentBanner = document.getElementById('cookie-consent-banner'), acceptBtn = document.getElementById('cookie-accept-btn'), declineBtn = document.getElementById('cookie-decline-btn'), acceptTimerSpan = document.getElementById('accept-timer');
            let countdownInterval, autoAcceptTimeout;
            function stopAllTimers() { clearInterval(countdownInterval); clearTimeout(autoAcceptTimeout); if (acceptTimerSpan) acceptTimerSpan.style.display = 'none'; }
            function handleConsent(isAccepted) { stopAllTimers(); localStorage.setItem('cookie_consent', isAccepted ? 'granted' : 'denied'); consentBanner.classList.add('hidden'); window.dataLayer = window.dataLayer || []; window.dataLayer.push({ 'event': 'consent_update', 'analytics_storage': isAccepted ? 'granted' : 'denied', 'ad_storage': isAccepted ? 'granted' : 'denied' }); }
            acceptBtn.addEventListener('click', () => handleConsent(true)); declineBtn.addEventListener('click', () => handleConsent(false));
            if (!localStorage.getItem('cookie_consent')) { consentBanner.classList.remove('hidden'); autoAcceptTimeout = setTimeout(() => handleConsent(true), 10000); let s = 10; acceptTimerSpan.textContent = `(${s})`; countdownInterval = setInterval(() => { s--; if (acceptTimerSpan) acceptTimerSpan.textContent = `(${s})`; if (s <= 0) clearInterval(countdownInterval); }, 1000); }

            let currentTranslations = {};
            const changeLanguage = async (lang) => {
                try {
                    const r = await fetch(`./lang/${lang}.json`);
                    if (!r.ok) throw new Error(`Could not load language file: ${lang}.json`);
                    currentTranslations = await r.json();
                } catch (e) {
                    console.error('Error fetching language file:', e);
                    return;
                }

                docEl.lang = lang;
                document.title = lang === 'id' ? 'PT Digital Sandi Informasi - Merancang Masa Depan Digital Anda' : 'PT Digital Sandi Informasi - Architecting Your Digital Future';
                window.location.hash = lang;
                document.querySelector('meta[name="description"]').setAttribute('content', currentTranslations['metaDescription']);

                // --- CHANGE #1: AVOID OVERWRITING THE HERO TITLE ---
                // We now check to make sure we are not targeting the 'heroTitle' element,
                // so our new animation function can control it exclusively.
                document.querySelectorAll('[data-lang-key]').forEach(el => {
                    const k = el.getAttribute('data-lang-key');
                    if (currentTranslations[k] && k !== 'heroTitle') { // <-- The important condition is added here
                        if (el.tagName === 'INPUT' && el.placeholder !== undefined) {
                            el.placeholder = currentTranslations[k];
                        } else {
                            el.innerHTML = currentTranslations[k];
                        }
                    }
                });

                document.getElementById('lang-id').classList.toggle('lang-active', lang === 'id');
                document.getElementById('lang-en').classList.toggle('lang-active', lang !== 'id');
                document.getElementById('lang-id-mobile').classList.toggle('lang-active', lang === 'id');
                document.getElementById('lang-en-mobile').classList.toggle('lang-active', lang !== 'id');

                // --- CHANGE #2: TRIGGER THE HERO TEXT ANIMATION ---
                // After all other text is updated, we specifically call the
                // new cycleHeroTitles function with the correct list of titles.
                if (currentTranslations['heroTitles'] && currentTranslations['heroTitles'].length > 0) {
                    cycleHeroTitles(currentTranslations['heroTitles']);
                }
            };

            // --- NEW: Hero Text Cycler with Re-animation ---
            const heroTitleElement = document.querySelector('[data-lang-key="heroTitle"]');
            let heroTitleIndex = 0;
            let heroInterval;

            function cycleHeroTitles(titles) {
                // Clear any existing animation timer to prevent conflicts
                if (heroInterval) clearInterval(heroInterval);

                // Shuffle the titles array to randomize the order
                const shuffledTitles = [...titles].sort(() => Math.random() - 0.5);

                // Initial animation on first load or language change
                heroTitleElement.textContent = shuffledTitles[0];
                heroTitleElement.classList.remove('hero-text-exit'); // Ensure it's visible
                heroTitleElement.classList.add('hero-text-enter');
                heroTitleIndex = 1;

                // Start cycling through the rest of the titles
                heroInterval = setInterval(() => {
                    // 1. Add the exit class to fade out the current text
                    heroTitleElement.classList.add('hero-text-exit');

                    // 2. Wait for the fade-out animation to complete
                    setTimeout(() => {
                        // 3. Change the text content to the next title
                        heroTitleElement.textContent = shuffledTitles[heroTitleIndex];

                        // 4. Reset the animation classes
                        heroTitleElement.classList.remove('hero-text-exit', 'hero-text-enter');

                        // 5. THE CRITICAL TRICK: Force a browser reflow.
                        // This makes the browser process the class removal before we re-add it.
                        void heroTitleElement.offsetWidth;

                        // 6. Re-add the enter class to trigger the "slide up and fade in" animation again
                        heroTitleElement.classList.add('hero-text-enter');

                        // 7. Move to the next title, looping back to the start if necessary
                        heroTitleIndex = (heroTitleIndex + 1) % shuffledTitles.length;

                    }, 500); // This must match the CSS transition duration for .hero-text-exit

                }, 3000); // Change text every 5 seconds
            }

            document.getElementById('lang-id').addEventListener('click', () => changeLanguage('id')); document.getElementById('lang-en').addEventListener('click', () => changeLanguage('en')); document.getElementById('lang-id-mobile').addEventListener('click', () => changeLanguage('id')); document.getElementById('lang-en-mobile').addEventListener('click', () => changeLanguage('en'));

            document.getElementById('mobile-menu-button').addEventListener('click', () => document.getElementById('mobile-menu').classList.toggle('hidden'));

            const observer = new IntersectionObserver(entries => { entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('is-visible'); }); }, { threshold: 0.2 });
            document.querySelectorAll('.fade-in-section').forEach(section => observer.observe(section));

            // --- NEW: Process Section Sequential Animation ---
            const processSection = document.getElementById('process');
            const processSteps = document.querySelectorAll('.process-step');
            const processConnectors = document.querySelectorAll('.process-connector');

            const processObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // Start the chain reaction animation
                        animateProcessSteps();
                        // Stop observing once the animation has started
                        processObserver.unobserve(processSection);
                    }
                });
            }, { threshold: 0.5 }); // Trigger when 50% of the section is visible

            // Only start observing if the process section exists
            if (processSection) {
                processObserver.observe(processSection);
            }

            function animateProcessSteps() {
                let delay = 200; // Initial delay in ms
                processSteps.forEach((step, index) => {
                    // Animate the circle
                    setTimeout(() => {
                        step.querySelector('.process-circle').classList.add('is-active');
                    }, delay);

                    // Animate the connector line after the circle
                    if (index < processConnectors.length) {
                        delay += 500; // Wait for circle animation
                        setTimeout(() => {
                            processConnectors[index].classList.add('is-active');
                        }, delay);
                        delay += 500; // Wait for line animation
                    }
                });
            }

            // --- NEW: Theme-Aware particles.js Initialization ---

            // Define your color settings for both themes
            const particleThemes = {
                light: {
                    particleColor: '#2997FF', // Blue for light mode
                    lineColor: '#2997FF'      // Blue for light mode
                },
                dark: {
                    particleColor: '#FFD700', // Yellowish color for particles
                    lineColor: '#FFD700'      // Yellowish color for lines
                }
            };

            // This function will initialize or update the particles with the correct colors
            function setupParticles(isDarkMode) {
                const theme = isDarkMode ? particleThemes.dark : particleThemes.light;

                particlesJS('particles-js', {
                    "particles": {
                        "number": {
                            "value": 63,
                            "density": {
                                "enable": true,
                                "value_area": 400.85
                            }
                        },
                        "color": { "value": theme.particleColor }, // <-- DYNAMIC COLOR
                        "shape": { "type": "circle" },
                        "opacity": {
                            "value": isDarkMode ? 0.5 : 0.4, // Slightly less opaque on light bg
                            "random": false
                        },
                        "size": {
                            "value": 3,
                            "random": true
                        },
                        "line_linked": {
                            "enable": true,
                            "distance": 150,
                            "color": theme.lineColor, // <-- DYNAMIC COLOR
                            "opacity": isDarkMode ? 0.4 : 0.2, // Less opaque on light bg
                            "width": 1
                        },
                        "move": {
                            "enable": true,
                            "speed": 0.8,
                            "direction": "none",
                            "random": false,
                            "straight": false,
                            "out_mode": "out",
                            "bounce": false
                        }
                    },
                    "interactivity": {
                        "detect_on": "canvas",
                        "events": {
                            "onhover": { "enable": false, "mode": "repulse" },
                            "onclick": { "enable": true, "mode": "push" },
                            "resize": true
                        },
                        "modes": {
                            "push": { "particles_nb": 4 }
                        }
                    },
                    "retina_detect": true
                });
            }

            // Initial setup on page load
            const isInitiallyDark = document.documentElement.classList.contains('dark');
            setupParticles(isInitiallyDark);

            const navLinks = document.querySelectorAll('header a[href^="#"]'), scrollSections = document.querySelectorAll('main section[id]');
            const activateNavOnScroll = () => { let c = 'hero'; scrollSections.forEach(s => { if (scrollY >= s.offsetTop - 150) c = s.getAttribute('id'); }); navLinks.forEach(l => { l.classList.remove('nav-active'); if (l.getAttribute('href').includes(c)) l.classList.add('nav-active'); }); };
            window.addEventListener('scroll', activateNavOnScroll);

            // --- AI Strategy Planner Feature (Gemini) ---
            const generateBtn = document.getElementById('generate-strategy-btn');
            const businessInput = document.getElementById('business-goal');
            const strategyOutput = document.getElementById('strategy-output');

            // NEW: Advanced typewriter function with live Markdown parsing and adaptive speed
            function typewriterEffect(element, text) {
                let i = 0;
                element.innerHTML = ""; // Clear the element
                element.classList.add('typing-cursor'); // Add blinking cursor

                // --- Adaptive Duration Logic ---
                // Calculate delay per character to finish in ~5 seconds (5000ms)
                // Set min/max delays to prevent it from being too fast or slow.
                const totalDuration = 1000;
                let delay = totalDuration / text.length;
                delay = Math.max(5, Math.min(delay, 75)); // Clamp delay between 10ms and 75ms

                function type() {
                    if (i < text.length) {
                        i++;
                        // Get the substring of the text typed so far
                        const partialText = text.substring(0, i);

                        // --- Live Markdown Parsing ---
                        // On each frame, parse the partial text and render it as HTML.
                        // This ensures formatting like headings and lists appear as they type.
                        element.innerHTML = marked.parse(partialText);

                        setTimeout(type, delay);
                    } else {
                        // Animation finished
                        element.classList.remove('typing-cursor');
                        // Final parse to ensure everything is perfect
                        element.innerHTML = marked.parse(text);
                    }
                }
                type();
            }

            generateBtn.addEventListener('click', async () => {
                const goal = businessInput.value.trim();

                // Validate input length and context
                if (goal.length < 40) {
                    strategyOutput.innerHTML = `<p class="text-red-400">${currentTranslations['aiErrorMinChars']}</p>`;
                    return;
                }

                // Check if the input is out of context
                const forbiddenWords = ['joke', 'unrelated', 'random', 'test', 'nonsense']; // Add more as needed
                if (forbiddenWords.some(word => goal.toLowerCase().includes(word))) {
                    strategyOutput.innerHTML = `<p class="text-red-400">The input seems out of context. Please provide a valid business goal.</p>`;
                    return;
                }

                generateBtn.disabled = true;
                generateBtn.innerHTML = '<div class="loader mx-auto"></div>';
                strategyOutput.innerHTML = `<div class="flex items-center justify-center text-gray-500 dark:text-gray-400"><p class="mr-2">Generating strategy</p><div class="typing-indicator"><span></span><span></span><span></span></div></div>`;

                try {
                    const response = await fetch('https://dsi-api-proxy.muhammadmaududy4.workers.dev/', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            systemInstruction: {
                                parts: [
                                    {
                                        text: "You are an expert consultant in Indonesian telecommunications. Provide concise and actionable advice. Limit your response to 500 words or less. Sometimes put your answer in a table format if it helps clarity."
                                    }
                                ]
                            },
                            contents: [
                                {
                                    parts: [
                                        {
                                            text: `Generate a high-level multichannel engagement strategy proposal for the following business goal: '${goal}'. Keep the response brief and focused.`
                                        }
                                    ]
                                }
                            ],
                            tools: [{ "google_search": {} }],
                        })
                    });

                    if (!response.ok) throw new Error(`API error: ${response.statusText}`);
                    const result = await response.json();
                    const geminiResponse = result.candidates?.[0]?.content?.parts?.[0]?.text;

                    strategyOutput.innerHTML = ''; // Clear the "thinking" animation

                    if (geminiResponse) {
                        const warningDiv = document.createElement('div');
                        warningDiv.className = 'ai-warning';
                        warningDiv.innerHTML = currentTranslations['aiWarning'];
                        strategyOutput.appendChild(warningDiv);

                        const responseDiv = document.createElement('div');
                        strategyOutput.appendChild(responseDiv);

                        // Start the typewriter effect
                        typewriterEffect(responseDiv, geminiResponse);
                    } else {
                        throw new Error("Invalid API response.");
                    }
                } catch (error) {
                    console.error("Error generating strategy:", error);
                    strategyOutput.innerHTML = `<p class="text-red-400">Sorry, we couldn't generate the strategy. Please try again later.</p>`;
                } finally {
                    generateBtn.disabled = false;
                    generateBtn.innerHTML = currentTranslations['aiBtn'];
                }
            });

            const initialLang = window.location.hash.replace('#', '') || 'id';
            changeLanguage(['id', 'en'].includes(initialLang) ? initialLang : 'id');
            activateNavOnScroll();
        });
    </script>
</body>

</html>